package eosio

import (
	"encoding/hex"
	"strings"
	"testing"

	"github.com/stretchr/testify/require"
)

func TestTransactionTraceDecoding(t *testing.T) {
	bytes, err := hex.DecodeString(strings.ReplaceAll(trxTraceInput1, "\n", ""))
	require.NoError(t, err)

	trxTrace := &TransactionTrace{}
	require.NoError(t, unmarshalBinary(bytes, trxTrace), err)
}

var trxTraceInput1 = `
6c3e20aa385f33696db04faba45bcfeddb1f76ab2623d2a7c315f0eea6be7f39220000000d220f4d0100000022fe44ad34ea4673561a6e512179b8abe054
f77532f6a92145fe6b067401024d050000008b0b00000000000000000000000000000001010000001052546ea998b3390000000000ea3055000000e0d27b
d5a4011052546ea998b33900000000a8ed32324f887766554433221188776655443322113e86d4f45e1f00b460fae500000100011052546ea998b3390000
004875d56f4e011052546ea998b33900000000a8ed32320c1052546ea998b3390100013100003600000000000000006c3e20aa385f33696db04faba45bcf
eddb1f76ab2623d2a7c315f0eea6be7f39220000000d220f4d0100000022fe44ad34ea4673561a6e512179b8abe054f77532f6a92145fe6b067400000114
8a2e00000000001b656f73696f5f6173736572745f636f64655f657863657074696f6e23656f73696f5f6173736572745f636f646520617373657274696f
6e206661696c75726502070307636f6e746578740707056c6576656c05056572726f720466696c65050d63665f73797374656d2e637070046c696e650229
00000000000000066d6574686f640511656f73696f5f6173736572745f636f646508686f73746e616d6505000b7468726561645f6e616d65050874687265
61642d300974696d657374616d700517323032312d31302d30375430373a33313a33352e36393106666f726d61740530617373657274696f6e206661696c
7572652077697468206572726f7220636f64653a20247b6572726f725f636f64657d046461746107010a6572726f725f636f6465020100203b9db5056f07
0307636f6e746578740707056c6576656c05047761726e0466696c6505116170706c795f636f6e746578742e637070046c696e65028f0000000000000006
6d6574686f640508657865635f6f6e6508686f73746e616d6505000b7468726561645f6e616d6505087468726561642d300974696d657374616d70051732
3032312d31302d30375430373a33313a33352e36393106666f726d6174052270656e64696e6720636f6e736f6c65206f75747075743a20247b636f6e736f
6c657d0464617461070107636f6e736f6c650500010100203b9db5056f00011052546ea998b339b2feffffffffffff01b39a0d34fa8145791a7ef3873014
661ceaae99ab652ea981c964d23e8094fa67220000000d220f4d0100000022fe44ad34ea4673561a6e512179b8abe054f77532f6a92145fe6b0674008e0a
00000000000000000000000000000101010000001052546ea998b3391052546ea998b3390000004875d56f4e011052546ea998b33900000000a8ed32320c
1052546ea998b3390100013100d9070000000000002a647472786578656320737461727420636f6e736f6c65206c6f672c206265666f7265206661696c69
6e67b39a0d34fa8145791a7ef3873014661ceaae99ab652ea981c964d23e8094fa67220000000d220f4d0100000022fe44ad34ea4673561a6e512179b8ab
e054f77532f6a92145fe6b0674000001138a2e00000000001e656f73696f5f6173736572745f6d6573736167655f657863657074696f6e26656f73696f5f
6173736572745f6d65737361676520617373657274696f6e206661696c75726502070307636f6e746578740707056c6576656c05056572726f720466696c
65050d63665f73797374656d2e637070046c696e65020e00000000000000066d6574686f64050c656f73696f5f61737365727408686f73746e616d650500
0b7468726561645f6e616d6505087468726561642d300974696d657374616d700517323032312d31302d30375430373a33313a33352e36383806666f726d
61740524617373657274696f6e206661696c7572652077697468206d6573736167653a20247b737d046461746107010173051b647472786578656320696e
737472756374656420746f206661696c070307636f6e746578740707056c6576656c05047761726e0466696c6505116170706c795f636f6e746578742e63
7070046c696e65028f00000000000000066d6574686f640508657865635f6f6e6508686f73746e616d6505000b7468726561645f6e616d65050874687265
61642d300974696d657374616d700517323032312d31302d30375430373a33313a33352e36393006666f726d6174052270656e64696e6720636f6e736f6c
65206f75747075743a20247b636f6e736f6c657d0464617461070107636f6e736f6c65052a647472786578656320737461727420636f6e736f6c65206c6f
672c206265666f7265206661696c696e67010000e8890423c78a00000001138a2e00000000001e656f73696f5f6173736572745f6d6573736167655f6578
63657074696f6e26656f73696f5f6173736572745f6d65737361676520617373657274696f6e206661696c75726502070307636f6e746578740707056c65
76656c05056572726f720466696c65050d63665f73797374656d2e637070046c696e65020e00000000000000066d6574686f64050c656f73696f5f617373
65727408686f73746e616d6505000b7468726561645f6e616d6505087468726561642d300974696d657374616d700517323032312d31302d30375430373a
33313a33352e36383806666f726d61740524617373657274696f6e206661696c7572652077697468206d6573736167653a20247b737d0464617461070101
73051b647472786578656320696e737472756374656420746f206661696c070307636f6e746578740707056c6576656c05047761726e0466696c65051161
70706c795f636f6e746578742e637070046c696e65028f00000000000000066d6574686f640508657865635f6f6e6508686f73746e616d6505000b746872
6561645f6e616d6505087468726561642d300974696d657374616d700517323032312d31302d30375430373a33313a33352e36393006666f726d61740522
70656e64696e6720636f6e736f6c65206f75747075743a20247b636f6e736f6c657d0464617461070107636f6e736f6c65052a6474727865786563207374
61727420636f6e736f6c65206c6f672c206265666f7265206661696c696e67010000e8890423c78a01148a2e00000000001b656f73696f5f617373657274
5f636f64655f657863657074696f6e23656f73696f5f6173736572745f636f646520617373657274696f6e206661696c75726502070307636f6e74657874
0707056c6576656c05056572726f720466696c65050d63665f73797374656d2e637070046c696e65022900000000000000066d6574686f640511656f7369
6f5f6173736572745f636f646508686f73746e616d6505000b7468726561645f6e616d6505087468726561642d300974696d657374616d70051732303231
2d31302d30375430373a33313a33352e36393106666f726d61740530617373657274696f6e206661696c7572652077697468206572726f7220636f64653a
20247b6572726f725f636f64657d046461746107010a6572726f725f636f6465020100203b9db5056f070307636f6e746578740707056c6576656c050477
61726e0466696c6505116170706c795f636f6e746578742e637070046c696e65028f00000000000000066d6574686f640508657865635f6f6e6508686f73
746e616d6505000b7468726561645f6e616d6505087468726561642d300974696d657374616d700517323032312d31302d30375430373a33313a33352e36
393106666f726d6174052270656e64696e6720636f6e736f6c65206f75747075743a20247b636f6e736f6c657d0464617461070107636f6e736f6c650500
010100203b9db5056f
`
